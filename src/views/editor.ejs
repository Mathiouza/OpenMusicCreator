<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
		<link rel="stylesheet" href="style.css" />
        <title>Editor - OpenMusicCreator</title>
    </head>
 
    <body>
		<div id="instru1" class="divInstru">
			<h1 class="titreInstru">Sine</h1>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="A" oct=-1 />
				<img src="touche.png" class="touche" tone="Bb" oct=-1 />
				<img src="touche.png" class="touche" tone="B" oct=-1 />
				<img src="touche.png" class="touche main" tone="C" oct=0 /><span class="label" >C</span>
				<img src="touche.png" class="touche" tone="C#" oct=0 />
				<img src="touche.png" class="touche" tone="D" oct=0 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="D" oct=0 />
				<img src="touche.png" class="touche" tone="Eb" oct=0 />
				<img src="touche.png" class="touche main" tone="E" oct=0 /><span class="label" >E</span>
				<img src="touche.png" class="touche" tone="F" oct=0 />
				<img src="touche.png" class="touche" tone="F#" oct=0 />
			</div>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="E" oct=0 />
				<img src="touche.png" class="touche" tone="F" oct=0 />
				<img src="touche.png" class="touche" tone="Gb" oct=0 />
				<img src="touche.png" class="touche main" tone="G" oct=0 /><span class="label" >G</span>
				<img src="touche.png" class="touche" tone="G#" oct=0 />
				<img src="touche.png" class="touche" tone="A" oct=0 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="G" oct=0 />
				<img src="touche.png" class="touche" tone="Ab" oct=0 />
				<img src="touche.png" class="touche main" tone="A" oct=0 /><span class="label" >A</span>
				<img src="touche.png" class="touche" tone="A#" oct=0 />
				<img src="touche.png" class="touche" tone="B" oct=0 />
			</div>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="A" oct=0 />
				<img src="touche.png" class="touche" tone="Bb" oct=0 />
				<img src="touche.png" class="touche" tone="B" oct=0 />
				<img src="touche.png" class="touche main" tone="C" oct=1 /><span class="label" >C</span>
				<img src="touche.png" class="touche" tone="C#" oct=1 />
				<img src="touche.png" class="touche" tone="D" oct=1 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="D" oct=1 />
				<img src="touche.png" class="touche" tone="Eb" oct=1 />
				<img src="touche.png" class="touche main" tone="E" oct=1 /><span class="label" >E</span>
				<img src="touche.png" class="touche" tone="F" oct=1 />
				<img src="touche.png" class="touche" tone="F#" oct=1 />
			</div>
		</div>
		<div id="instru2" class="divInstru">
			<h1 class="titreInstru">Sawtooth</h1>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="A" oct=-1 />
				<img src="touche.png" class="touche" tone="Bb" oct=-1 />
				<img src="touche.png" class="touche" tone="B" oct=-1 />
				<img src="touche.png" class="touche main" tone="C" oct=0 />
				<img src="touche.png" class="touche" tone="C#" oct=0 />
				<img src="touche.png" class="touche" tone="D" oct=0 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="Db" oct=0 />
				<img src="touche.png" class="touche" tone="D" oct=0 />
				<img src="touche.png" class="touche" tone="Eb" oct=0 />
				<img src="touche.png" class="touche main" tone="E" oct=0 />
				<img src="touche.png" class="touche" tone="F" oct=0 />
				<img src="touche.png" class="touche" tone="F#" oct=0 />
				<img src="touche.png" class="touche" tone="G" oct=0 />
			</div>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="E" oct=0 />
				<img src="touche.png" class="touche" tone="F" oct=0 />
				<img src="touche.png" class="touche" tone="Gb" oct=0 />
				<img src="touche.png" class="touche main" tone="G" oct=0 />
				<img src="touche.png" class="touche" tone="G#" oct=0 />
				<img src="touche.png" class="touche" tone="A" oct=0 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="Gb" oct=0 />
				<img src="touche.png" class="touche" tone="G" oct=0 />
				<img src="touche.png" class="touche" tone="Ab" oct=0 />
				<img src="touche.png" class="touche main" tone="A" oct=0 />
				<img src="touche.png" class="touche" tone="A#" oct=0 />
				<img src="touche.png" class="touche" tone="B" oct=0 />
				<img src="touche.png" class="touche" tone="C" oct=1 />
			</div>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="A" oct=0 />
				<img src="touche.png" class="touche" tone="Bb" oct=0 />
				<img src="touche.png" class="touche" tone="B" oct=0 />
				<img src="touche.png" class="touche main" tone="C" oct=1 />
				<img src="touche.png" class="touche" tone="C#" oct=1 />
				<img src="touche.png" class="touche" tone="D" oct=1 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="Db" oct=1 />
				<img src="touche.png" class="touche" tone="D" oct=1 />
				<img src="touche.png" class="touche" tone="Eb" oct=1 />
				<img src="touche.png" class="touche main" tone="E" oct=1 />
				<img src="touche.png" class="touche" tone="F" oct=1 />
				<img src="touche.png" class="touche" tone="F#" oct=1 />
				<img src="touche.png" class="touche" tone="G" oct=1 />
			</div>
		</div>
		<div id="instru3" class="divInstru">
			<h1 class="titreInstru">Triangle</h1>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="A" oct=-1 />
				<img src="touche.png" class="touche" tone="Bb" oct=-1 />
				<img src="touche.png" class="touche" tone="B" oct=-1 />
				<img src="touche.png" class="touche main" tone="C" oct=0 />
				<img src="touche.png" class="touche" tone="C#" oct=0 />
				<img src="touche.png" class="touche" tone="D" oct=0 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="D" oct=0 />
				<img src="touche.png" class="touche" tone="Eb" oct=0 />
				<img src="touche.png" class="touche main" tone="E" oct=0 />
				<img src="touche.png" class="touche" tone="F" oct=0 />
				<img src="touche.png" class="touche" tone="F#" oct=0 />
			</div>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="E" oct=0 />
				<img src="touche.png" class="touche" tone="F" oct=0 />
				<img src="touche.png" class="touche" tone="Gb" oct=0 />
				<img src="touche.png" class="touche main" tone="G" oct=0 />
				<img src="touche.png" class="touche" tone="G#" oct=0 />
				<img src="touche.png" class="touche" tone="A" oct=0 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="G" oct=0 />
				<img src="touche.png" class="touche" tone="Ab" oct=0 />
				<img src="touche.png" class="touche main" tone="A" oct=0 />
				<img src="touche.png" class="touche" tone="A#" oct=0 />
				<img src="touche.png" class="touche" tone="B" oct=0 />
			</div>
			<div class="lineP">
				<img src="touche.png" class="touche" tone="A" oct=0 />
				<img src="touche.png" class="touche" tone="Bb" oct=0 />
				<img src="touche.png" class="touche" tone="B" oct=0 />
				<img src="touche.png" class="touche main" tone="C" oct=1 />
				<img src="touche.png" class="touche" tone="C#" oct=1 />
				<img src="touche.png" class="touche" tone="D" oct=1 />
			</div>
			<div class="lineI">
				<img src="touche.png" class="touche" tone="D" oct=1 />
				<img src="touche.png" class="touche" tone="Eb" oct=1 />
				<img src="touche.png" class="touche main" tone="E" oct=1 />
				<img src="touche.png" class="touche" tone="F" oct=1 />
				<img src="touche.png" class="touche" tone="F#" oct=1 />
			</div>
		</div>
		
		<script src="wad.js"></script>
		<script>
			var funcMOv = function(object) {
				var value = 0, instru = 'sine';
				if(object.parentNode.parentNode.getAttribute('id') == 'instru2') { value = 120; instru = 'sawtooth'; }
				else if(object.parentNode.parentNode.getAttribute('id') == 'instru3') { value = 240; instru = 'triangle'; }
				if(object.getAttribute('class') == 'touche main') value -= 60;
				object.setAttribute('style', 'filter: sepia() saturate(1000%) hue-rotate('+value+'deg)');
				if(mouseDown) {
					object.setAttribute('style', 'filter: sepia() saturate(20%) hue-rotate('+value+'deg)');
					
					var str = object.getAttribute('tone')+(parseInt(object.getAttribute('oct'))+octave);
					playSomething(instru, str);
				}
			}
		
			var funcMD = function(object) {
				var value = 0, instru = 'sine';
				if(object.parentNode.parentNode.getAttribute('id') == 'instru2') { value = 120; instru = 'sawtooth'; }
				else if(object.parentNode.parentNode.getAttribute('id') == 'instru3') { value = 240; instru = 'triangle'; }
				if(object.getAttribute('class') == 'touche main') value -= 60;
				object.setAttribute('style', 'filter: sepia() saturate(20%) hue-rotate('+value+'deg)');
				
				var str = object.getAttribute('tone')+(parseInt(object.getAttribute('oct'))+octave);
				playSomething(instru, str);
			}
		
			var funcMU = function(object) {
				var value = 0, instru = 'sine';
				if(object.parentNode.parentNode.getAttribute('id') == 'instru2') { value = 120; instru = 'sawtooth'; }
				else if(object.parentNode.parentNode.getAttribute('id') == 'instru3') { value = 240; instru = 'triangle'; }
				if(object.getAttribute('class') == 'touche main') value -= 60;
				object.setAttribute('style', 'filter: sepia() saturate(1000%) hue-rotate('+value+'deg)');
				
				var str = object.getAttribute('tone')+(parseInt(object.getAttribute('oct'))+octave);
				stopPlaying(instru, str);
			}
		
			var funcMOu = function(object) {
				var value = 0, instru = 'sine';
				if(object.parentNode.parentNode.getAttribute('id') == 'instru2') { value = 120; instru = 'sawtooth'; }
				else if(object.parentNode.parentNode.getAttribute('id') == 'instru3') { value = 240; instru = 'triangle'; }
				if(object.getAttribute('class') == 'touche main') value -= 60;
				object.setAttribute('style', 'filter: sepia() saturate(100000%) hue-rotate('+value+'deg)');
				if(mouseDown) {
					var str = object.getAttribute('tone')+(parseInt(object.getAttribute('oct'))+octave);
					stopPlaying(instru, str);
				}
			}
		
		
			document.onselectstart = function() {return false};
			if(window.sidebar)
			{
				document.onmousedown = function() {return false};
				document.onclick = function() {return true};
			}
		
		
			function playSomething(instru, pitch) {
				if(instru == 'sine') instru1.play({pitch:pitch,label:pitch});
				else if(instru == 'sawtooth') instru2.play({pitch:pitch,label:pitch});
				else if(instru == 'triangle') instru3.play({pitch:pitch,label:pitch});
			}
			
			function stopPlaying(instru, pitch) {
				if(instru == 'sine') instru1.stop(pitch);
				else if(instru == 'sawtooth') instru2.stop(pitch);
				else if(instru == 'triangle') instru3.stop(pitch);
			}
		
			var instru1 = new Wad({
				source : 'sine',
				volume : 1.0, // Peak volume can range from 0 to an arbitrarily high number, but you probably shouldn't set it higher than 1.
				pitch : 'A4', // Set a default pitch on the constuctor if you don't want to set the pitch on play().
				panning : 0, // Horizontal placement of the sound source. Sensible values are from 10 to -10.
				env : { // This is the ADSR envelope.
					attack : 0.0, // Time in seconds from onset to peak volume.  Common values for oscillators may range from 0.05 to 0.3.
					decay : 0.0, // Time in seconds from peak volume to sustain volume.
					sustain : 1, // Sustain volume level. This is a percent of the peak volume, so sensible values are between 0 and 1.
					hold : 9000, // Time in seconds to maintain the sustain volume level. If this is not set to a lower value, oscillators must be manually stopped by calling their stop() method.
					release : 1 // Time in seconds from the end of the hold period to zero volume, or from calling stop() to zero volume.
				},
			});
			
			var instru2 = new Wad({
				source : 'sawtooth',
				volume : 1, // Peak volume can range from 0 to an arbitrarily high number, but you probably shouldn't set it higher than 1.
				pitch : 'A4', // Set a default pitch on the constuctor if you don't want to set the pitch on play().
				panning : 0, // Horizontal placement of the sound source. Sensible values are from 10 to -10.
				env : { // This is the ADSR envelope.
					attack : 1, // Time in seconds from onset to peak volume.  Common values for oscillators may range from 0.05 to 0.3.
					decay : 1, // Time in seconds from peak volume to sustain volume.
					sustain : 1, // Sustain volume level. This is a percent of the peak volume, so sensible values are between 0 and 1.
					hold : 9000, // Time in seconds to maintain the sustain volume level. If this is not set to a lower value, oscillators must be manually stopped by calling their stop() method.
					release : 1 // Time in seconds from the end of the hold period to zero volume, or from calling stop() to zero volume.
				},
			});
			
			var instru3 = new Wad({
				source : 'triangle',
				volume : 1.0, // Peak volume can range from 0 to an arbitrarily high number, but you probably shouldn't set it higher than 1.
				pitch : 'A4', // Set a default pitch on the constuctor if you don't want to set the pitch on play().
				panning : 0, // Horizontal placement of the sound source. Sensible values are from 10 to -10.
				env : { // This is the ADSR envelope.
					attack : 0.0, // Time in seconds from onset to peak volume.  Common values for oscillators may range from 0.05 to 0.3.
					decay : 0.0, // Time in seconds from peak volume to sustain volume.
					sustain : 1, // Sustain volume level. This is a percent of the peak volume, so sensible values are between 0 and 1.
					hold : 9000, // Time in seconds to maintain the sustain volume level. If this is not set to a lower value, oscillators must be manually stopped by calling their stop() method.
					release : 1 // Time in seconds from the end of the hold period to zero volume, or from calling stop() to zero volume.
				},
			});
		
			var octave = 3;
		
			var mouseDown = 0;
			document.body.onmousedown = function() { 
			  ++mouseDown;
			}
			document.body.onmouseup = function() {
			  --mouseDown;
			}
		
			var el = document.querySelectorAll('img');
			for (var i = 0 ; i < el.length ; i++) {
				el[i].addEventListener('mousedown', function(e){
					e.preventDefault();
				}, false);
				el[i].addEventListener('mousemove', function(e){
					e.preventDefault();
				}, false);
			}
			var instrus = document.querySelectorAll('.touche');
			for(var i = 0 ; i < instrus.length ; i++) {
				instrus[i].addEventListener('mouseover', function(e) {
					funcMOv(e.currentTarget);
				});
				instrus[i].addEventListener('mousedown', function(e) {
					funcMD(e.currentTarget);
				});
				instrus[i].addEventListener('mouseup', function(e) {
					funcMU(e.currentTarget);
				});
				instrus[i].addEventListener('mouseout', function(e) {
					funcMOu(e.currentTarget);
				});
			}
			var labels = document.querySelectorAll('.label');
			for(var i = 0 ; i < instrus.length ; i++) {
				labels[i].addEventListener('mouseover', function(e) {
					funcMOv(e.currentTarget.previousSibling);
				});
				labels[i].addEventListener('mousedown', function(e) {
					funcMD(e.currentTarget.previousSibling);
				});
				labels[i].addEventListener('mouseup', function(e) {
					funcMU(e.currentTarget.previousSibling);
				});
				labels[i].addEventListener('mouseout', function(e) {
					funcMOu(e.currentTarget.previousSibling);
				});
			}
		</script>
    </body>
</html>